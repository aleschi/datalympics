<div class="SD_page">
  <h1 class="SD_title SD_title2">Suivi des conventions </h1>
    <h1 class="SD_subtitle">Dernière mise à jour : <% if !Convention.last.nil?%><%= l(Convention.last.updated_at, format: "%e %B %Y") %> <% end %> </h1>

  <div  class="SD-table-box">
    <div class="SF-topo-financeurs-title"><span>Suivi des conventions </span></div><br><br>

    <% if !@conventions.nil?%>
      <div class="flexslider2" id="flexslider">
        <ul class="slides">
        <% @conventions.order('date DESC').each_with_index do |convention,i| %>
        <li> 
          <div class="budget-ouvrages-mois">
            <div class="box-convention-date"><%= l(convention.date, format: "%e %B %Y") %> </div>
              <div class="inline-flex">
                <div id="container<%=i%>"></div>
                <div class="convention-infos">
                  <div class="c2 fs14"><span class="c1 fs20"><%= convention.objectifs_signature + convention.travaux_signature + convention.etudes_signature%></span> Conventions signées </div>
                  <div class="i4"></div>
                  <div class="c2 fs14"><span class="c1 fs20"><%= convention.objectifs_encours%></span> CDO en cours de signature</div>
                  <div class="i4"></div>
                  <div class="c2 fs14"><span class="c1 fs20"><%= convention.avenants_objectifs_encours%></span> Avenants aux CDO en cours</div>
                  <div class="i4"></div>
                  <div class="c2 fs14"><span class="c1 fs20"><%= convention.avenants_travaux_encours%> </span> Avenants aux CTRAV en cours</div>
                  <div class="i4"></div>
                  <div class="c2 fs14"><span class="c1 fs20"><%= convention.protocole_etudes_encours%> </span>Protocoles d'études en cours de signature (VDP)</div>
                  <div class="i4"></div>
                  <div class="c2 fs14"><span class="c1 fs20"><%= convention.objectifs_elaboration%></span> CDO en cours d’élaboration</div>
                </div>
              </div>
              <script>
                Highcharts.chart('container<%=i%>', {
                    chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: null,
                        plotShadow: false,
                        type: 'pie',
                        backgroundColor: '#fff',
                          style:{
                          fontFamily: "Marianne Regular",
                    
                          },
                      
                    },
                    title: {
                         text:null,   
                          style: {
                                  color: "#8F8F8F",
                                  fontWeight: "400",
                                  fontStyle: "italic",
                                  fontSize: '16px',
                                  },
                    },
                    colors: ['#2E5D63','#C68D7B', '#20E37B'],
                    tooltip: {
                        pointFormat: '{series.name}: <b>{point.y} </b>',
                      borderColor: 'transparent',
                      borderRadius: 16,
                      backgroundColor: '#fff',
                      },
                
                    plotOptions: {
                        pie: {
                            allowPointSelect: true,
                            cursor: 'pointer',
                           size: 200,
                            dataLabels: {
                                enabled: true,
                                format: '<b>{point.name}</b><br>{point.y}',
                                useHTML: true,
                                distance:10,
                                padding:0,
                              style: {
                                      color: "#8F8F8F",
                                      fontSize: "11px",
                                      fontWeight: "400",
                                      fontStyle: "italic",
                                      },
                            }
                        }
                    },
                    series: [{
                        name: 'Conventions signées',
                        colorByPoint: true,
                        innerSize: '80%',
                        data: [ {
                            name: 'Convention études',
                            y: <%= convention.etudes_signature%>,
                        },{
                            name: 'Conventions travaux',
                            y: <%= convention.travaux_signature%>,
                        }, {
                            name: 'Conventions objectifs',
                            y: <%= convention.objectifs_signature%>,
                        }]
                    }]
                });
              </script>
          </div>
        </li>
        <% end %>
        </ul>
      </div>
    <% end %>
  </div>
</div>

  <script>

  $('.menu-ouvrages-conventions').addClass('menu-active2'); 
  $('.menu-ouvrages').addClass('menu-active'); 

  $('#MonCollapse3').addClass('in'); 

</script>