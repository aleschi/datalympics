<div class="SD_page">
  <h1 class="SD_title SD_title2">Suivi des conventions </h1>

  <div  class="SD-table-box">
    <div class="SF-topo-financeurs-title"><span>Suivi des conventions </span></div><br><br>

    <% if !@conventions.nil?%>
      <div class="conventions">
        <% @conventions.order('date DESC').each_with_index do |convention,i| %>
          <div class="box-convention">
            <div class="box-convention-date"><%= l(convention.date, format: "%e %B %Y") %> </div>
            <div class="inline-flex">
              <div id="container<%=i%>"></div>
              <div class="convention-infos">
                <div class="reporting-text"><%= convention.objectifs_encours%> CDO en cours de signature</div>
                <div class="reporting-text"><%= convention.avenants_objectifs_encours%> Avenants aux CDO en cours</div>
                <div class="reporting-text"><%= convention.avenants_travaux_encours%> Avenants aux CTRAV en cours</div>
                <div class="reporting-text"><%= convention.protocole_etudes_encours%> Protocoles d'études en cours de signature (VDP)</div>
                <div class="reporting-text"><%= convention.objectifs_elaboration%> CDO en cours d’élaboration</div>
              </div>
            </div>
            <script>
              Highcharts.chart('container<%=i%>', {
                  chart: {
                      plotBackgroundColor: null,
                      plotBorderWidth: null,
                      plotShadow: false,
                      type: 'pie',
                      backgroundColor: '#fff',
                        style:{
                        fontFamily: "Marianne Regular",
                  
                        },
                    height: '350px',
                  },
                  title: {
                       text:null,   
                        style: {
                                color: "#8F8F8F",
                                fontWeight: "400",
                                fontStyle: "italic",
                                fontSize: '16px',
                                },
                  },
                  colors: ['#2E5D63','#C68D7B', '#20E37B'],
                  tooltip: {
                      pointFormat: '{series.name}: <b>{point.y} </b>',
                    borderColor: 'transparent',
                    borderRadius: 16,
                    backgroundColor: '#fff',
                    },
              
                  plotOptions: {
                      pie: {
                          allowPointSelect: true,
                          cursor: 'pointer',
                         size: 200,
                          dataLabels: {
                              enabled: true,
                              format: '<b>{point.name}</b><br>{point.y}',
                            style: {
                                    color: "#8F8F8F",
                                    fontSize: "11px",
                                    fontWeight: "400",
                                    fontStyle: "italic",
                                    },
                          }
                      }
                  },
                  series: [{
                      name: 'Conventions signées',
                      colorByPoint: true,
                      data: [{
                          name: 'Conventions travaux',
                          y: <%= convention.travaux_signature%>,
                      }, {
                          name: 'Conventions objectifs',
                          y: <%= convention.objectifs_signature%>,
                      }, {
                          name: 'Convention études',
                          y: <%= convention.etudes_signature%>,
                      }]
                  }]
              });
            </script>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
</div>

  