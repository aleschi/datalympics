<% if !@solideo_financements.nil?%>
<div class="SD-topo-box">
  <div class="SF-topo-financeurs-title"><span>Liste des collectivités</span></div><br><br>
   
<div class="row">
  <div class="col-md-6">
    <div id='container-pie'>
    <%= pie_chart @solideo_financements.unscope(:order).group(:financeur).sum(:montant_prevu) ,  library: {
     chart: {
       plotBackgroundColor: nil,
        plotBorderWidth: nil,
        plotShadow: false,
       backgroundColor: '#fff',
        type: 'pie',

       style:{
          fontFamily: "Marianne Regular",
         maxWidth: "500px",
          },
    },
    colors: ["#8993F5","#89E5DC","#8BC8FD","#3B3B3F","#9CFF90", "#FFB458","#FF678F", "#FDEB6B", "#37A09E","#F54E53","#89C7FD"],

      title: {
        text:'Répartition des financements des collectivités (prev 2018) ',
   
        style: {
          color: '#8F8F8F',
          fontSize: '16px',
          fontStyle: 'italic',
          }
      },
  tooltip: {
       borderColor: 'transparent',
   borderRadius: 16,
   backgroundColor: '#fff',
    },
     plotOptions: {
        pie: {
            innerSize: 130,
           allowPointSelect: true,
            cursor: 'pointer',
          minSize: 200,
            dataLabels: {
                    enabled: true,
                    format: '<em>{point.name}<br>{point.percentage:.1f} %</em>',
                    style: {
                      color: "#8F8F8F",
                      fontSize: "11px",
                      fontWeight: "400",

                      }
                },
        }
    },
  }
   
    %>
      
    </div>
  

  </div>
  <div class="col-md-6">
    
    <div class="SF-topo-financeurs-box">
      <div class="SF-topo-financeurs-name"></div>
      <div class="SF-topo-financeurs-budget"><div class="SF-topo-financeurs-budget-prevu"><em>Fin. prévus €</em></div><div class="SF-topo-financeurs-budget-actuel"> | <em>Evolution</em></div></div>
    </div> <br><br>
   
    <% @financeurs.each do |financeur| %>
    <div class="SF-topo-financeurs-box">
      <div class="SF-topo-financeurs-name"><%= link_to solideo_financement_path(id: SolideoFinancement.where("financeur = ?", financeur).first.id) do %><%= financeur %> <% end %></div>
      <div class="SF-topo-financeurs-budget"><div class="SF-topo-financeurs-budget-prevu"><%= number_with_delimiter(SolideoFinancement.where("financeur = ?", financeur).sum('montant_prevu').to_i, :delimiter => ' ')%> €</div><div class="SF-topo-financeurs-budget-actuel"> | <i class="fas fa-chart-line"></i> +4%</div></div>
    </div>           
   
    <% end %>
  </div>
 
</div>
</div>
<% end %>
