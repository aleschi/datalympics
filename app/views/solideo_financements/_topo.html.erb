<% if !@solideo_financements.nil?%>
<div class="SF-topo-box">
   
  <div class="topo-chart">
    <%= pie_chart @solideo_financements.unscope(:order).group(:financeur).sum(:montant_prevu) ,  library: {
     chart: {
       backgroundColor: '#F3F8FF',
        type: 'pie',
        options3d: {
            enabled: true,
            alpha: 45
        },
       style:{
          fontFamily: "Spectral",
          },
    },

      title: {
        text:'<em>Financements de la Solideo</em>',
        margin:40,
        style: {
          color: '#8F8F8F',
        
          }
      },
     plotOptions: {
        pie: {
            innerSize: 100,
            depth: 45,
          dataLabels: {
                    enabled: true,
                    format: '<em>{point.name}<br>{point.y:,.0f}€ - {point.percentage:.1f} %</em>',
                    style: {
                      color: "#8F8F8F",
                      fontSize: "12px",
                      fontWeight: "400",

                      }
                }
        }
    },
  }
   
    %>

  </div>
 
  <div class="SF-topo-financeurs">
    <div class="SF-topo-financeurs-title"><span>Financeurs</span></div><br>
   
    <div class="SF-topo-financeurs-box">
      <div class="SF-topo-financeurs-name"></div>
      <div class="SF-topo-financeurs-budget"><div class="SF-topo-financeurs-budget-prevu"><em>Fin. prévus €</em></div><div class="SF-topo-financeurs-budget-actuel"> | <em>Fin. actuels €</em></div></div>
    </div> <br><br>
   
    <% @financeurs.each do |financeur| %>
    <div class="SF-topo-financeurs-box">
      <div class="SF-topo-financeurs-name"><% if financeur == "Etat"%><%= link_to etat_budgets_path do %><%= financeur %><%end%> <%else%><%= link_to solideo_financement_path(id: SolideoFinancement.where("financeur = ?", financeur).first.id) do %><%= financeur %> <%end%><% end %></div>
      <div class="SF-topo-financeurs-budget"><div class="SF-topo-financeurs-budget-prevu"><%= number_with_delimiter(SolideoFinancement.where("financeur = ?", financeur).sum('montant_prevu').to_i, :delimiter => ' ')%> €</div><div class="SF-topo-financeurs-budget-actuel"> | <%= number_with_delimiter((SolideoFinancement.where("financeur = ?", financeur).sum('montant').to_i), :delimiter => ' ') %> €</div></div>
    </div>           
   
    <% end %>
  </div>
  
 
</div>
<% end %>
