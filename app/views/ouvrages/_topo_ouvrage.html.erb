
  <div class="row">

  <div class="col-md-8">
    <div class="SD-table-box ouvrage-topo-box">
      <div class="row">
        <div class="col-md-6">
           <div class="O-topo-image">
            <% if @ouvrage.photo.attached? %>
            <%= image_tag @ouvrage.photo%>
            <% end %>
          </div>
          <div class="O-topo-infos-text">
            Lieu : <%= @ouvrage.adresse %><br>
            MOA : <%= @ouvrage.maitre_oeuvre %><br>
            Budget : <%= number_with_delimiter(@ouvrage.budget.to_i, :delimiter => ' ')%> €<br>
          </div>
        </div>
        <div class="col-md-6">
          <div id="container-jauge">
            
          </div>
        </div>
        </div>
    </div>
  </div>
    <div class="col-md-4">
      <div class="SD-table-box ouvrage-topo-box">
        <div class="SD-topo-box-title">
            <span>Risques identifiés</span>
         </div><br><br>
        <div class="jauge-risques">
          <div class="risque1"></div>
          <div class="risque2"></div>
          <div class="risque3 "></div>
          <div class="risque4 risque-active"></div>
          <div class="risque5"></div>
        </div>
        
        <div class="ouvrages-risques">
          <i class="fas fa-exclamation-circle"></i> 2 risques identifiés
        </div>
        <div class="ouvrages-risques-infos">
          <i class="fas fa-exclamation-triangle"></i> Chantier A, délai<br>
          <i class="fas fa-exclamation-triangle"></i> Chantier B, budget 
        </div>
      </div>
    </div>
 
 
</div><br><br>

 <script
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCzB6sn07VIK_DzRsbm87THvZtEO1qPaNg&map_ids=4c4b12db708d00c6&callback=initMap"
      defer
    ></script>
<script>

function initMap() {
  var map = new google.maps.Map(document.getElementById("map2"), {
    center: { lat: <%= @ouvrage.latitude%>, lng: <%= @ouvrage.longitude%> },
    zoom: 11,
     mapId: "4c4b12db708d00c6",
  });

  var infowindow = new google.maps.InfoWindow({
                         content:''
                       });
              var image = {
                          path: 'M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z',
                          fillColor: '#000091',
                          fillOpacity: 1,
                          scale: 0.5,
                          strokeColor: '#000091',
                          strokeWeight: 1,
                          labelOrigin: new google.maps.Point(0, -30)
                        };
              var image2 ={
                          path: 'M0-48c-9.8 0-17.7 7.8-17.7 17.4 0 15.5 17.7 30.6 17.7 30.6s17.7-15.4 17.7-30.6c0-9.6-7.9-17.4-17.7-17.4z',
                          fillColor: '#000091',
                          fillOpacity: 1,
                          scale: 0.6,
                          strokeColor: '#000091',
                          strokeWeight: 14,
                          labelOrigin: new google.maps.Point(0, -30)
                        };
  
  
        
                        
                var marker = new google.maps.Marker({
                                position: {lat: <%= @ouvrage.latitude%>, lng: <%= @ouvrage.longitude%>},
                                map: map,
                                icon: image,
                                map_icon_label: '<span class="map-icon map-icon-hardware-store"></span>',
                              });
                
                      
                          
                
                  AddMouseover(marker, image, image2);
                      
         
                }
                      
                function AddMouseover(marker, image, image2){
                        google.maps.event.addListener(marker,'mouseover', function() {
                              marker.setIcon(image2);
                              var label = this.getLabel();
                                label.color="#3233FF";
                              this.setLabel(label)
                            });
                        google.maps.event.addListener(marker,'mouseout', function() {
                              marker.setIcon(image);
                              var label = this.getLabel();
                                label.color="white";
                              this.setLabel(label)
                            });
                      
                }
                     
                      
</script>

<script>

Highcharts.chart('container-jauge', {

    chart: {
        type: 'solidgauge',
        height: '200px',
     
    },

    title: {
        text: null,
       
    },

    tooltip: {
        borderWidth: 0,
        backgroundColor: 'none',
        shadow: false,
        style: {
            fontSize: '16px'
        },
        valueSuffix: '%',
        pointFormat: '',
        positioner: function (labelWidth) {
            return {
                x: (this.chart.chartWidth - labelWidth) / 2,
                y: (this.chart.plotHeight / 2) + 15
            };
        }
    },

    pane: {
        startAngle: 0,
        endAngle: 360,
        background: [{ // Track for Move
            outerRadius: '100%',
            innerRadius: '88%',
            backgroundColor: "#C4C4C4",
            borderWidth: 0
        }]
    },

    yAxis: {
        min: 0,
        max: 100,
        lineWidth: 0,
        tickPositions: []
    },

    plotOptions: {
        solidgauge: {
            
          tooltip: "",
          
            dataLabels: {
              enabled: true,
              borderWidth: 0,
              backgroundColor: 'none',
              shadow: false,
              style: {
                  fontSize: '14px',
                color: '#004A70',
              },
              valueSuffix: '%',
              format: '<span style="color:#5770BE; font-size:12px;font-weight:400">{series.name} :</span><br><span style="font-size:16px; color: {point.color}; font-weight: bold">{point.y:,.0f} %</span>',
            verticalAlign: 'middle',
              align: 'center',
        
            },
            linecap: 'round',
            stickyTracking: false,
            rounded: true
        }
    },

    series: [{
        name: 'Budget consommé',
        data: [{
            color: "#F29D53",
            radius: '100%',
            innerRadius: '88%',
            y: 33
        }]
    }]
});
  </script>

