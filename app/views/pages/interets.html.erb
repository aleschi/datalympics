<%= render 'shared/navlogin_form'%>
<script>
  AOS.init();
</script>
<div class='background'>
<%= render 'layouts/navigation_public'%> 
</div>
<div class='background'>
  <div class="page-public">

  <div class="row">
    <div class="col-md-12">
      <div class="public-title">À quoi sert le budget des JOP24 ?</div>
      <div class="tp1">
            Le budget des JOP2024 sert en grande partie à construire, aménager et rénover les ouvrages accueillants les sportifs pour la compétition. Il existera au total 85 ouvrages olympiques et paralympiques. Afin de limiter les coûts, 85% des ouvrages sont des ouvrages existants, qui seront aménagés et rénovés pour les compétitions.
      </div> 
      <div class="i24"></div>
       
      <div id="interets-map">
        <div class="inline-flex">
            <div class="public-map-choice choice-renovation"><a><i class="fas fa-map-marker"></i> Espaces rénovés (<%= OuvragesPublic.where('travaux = ?','Rénovation').count%>)</a></div>
            <div class="public-map-choice choice-construction"><a><i class="fas fa-map-marker"></i> Espaces construits (<%= OuvragesPublic.where('travaux = ?','Construction').count%>)</a></div>
            <div class="public-map-choice choice-olympiques"><a><i class="fas fa-map-marker"></i> Aménagement (<%= OuvragesPublic.where('travaux = ?','Amenagement').count%>)</a></div>
            <div class="public-map-choice choice-para"><a>SOLIDEO (<%= OuvragesPublic.where('appartenance = ?','Solideo').count%>)</a></div>
            <div class="public-map-choice choice-para"><a>COJO (<%= OuvragesPublic.where('appartenance = ?','Cojo').count%>)</a></div>

            <%= search_form_for @q, url: recherche_ouvrages_publics_path , method: :get, remote: true, id: "search-form" do |f| %>
              <div class="ouvrages-search">
              <%= f.search_field :name_cont,class: "ouvrages-search-field", id:"name",placeholder: "Cherchez une discipline", data: {autocomplete_source: utilisation_budget_path} %> 
              <%= f.button :submit, id:"submit_button", class:"ouvrages-submit" do %><i class="fas fa-search"></i><% end %>
              </div>
            <% end %>
        </div>
        <%= render 'interets_map'%>
      </div>

    </div>

  </div>

</div>

</div>

<div class='background'>
<%= render 'layouts/footer'%> 
</div>

<script>

  $(function() {
 // var matieres = ["Stade de france", "Arena 2", "village"]
  // Below is the name of the textfield that will be autocomplete    
    $('#name').autocomplete({
 // This is the source of the auocomplete suggestions. In this case a list of names from the people controller, in JSON format.
     
      source: $('#name').data('autocomplete-source'),
          //  source:matieres,
           
      select: function(event, ui) {
       // $.ajax({
       //   type:'GET',
       //   url: '/ouvrages',
          
        //});
        $("#name").val(ui.item.label);
          $("#submit_button").click()    

    },
        })
     .data("ui-autocomplete")._renderItem = function(ul, item){
       var expression = new RegExp(this.term, "gi");
      var result = expression.exec(item.label);
      var answer; 
      if (result.index == 0){
        answer = item.label.replace(expression, "<span style='font-weight:bold;color:#000091'>" + this.term + "</span>");
        return $("<li></li>")
      .append("<a>"+answer+"</a>")
      .prependTo(ul);
      }   
      else
       answer = item.label.replace(expression, "<span style='font-weight:bold;color:#000091'>" + this.term.toLowerCase() + "</span>");
      return $("<li></li>")
      .append("<a>"+answer+"</a>")
      .appendTo(ul);
     
    };
    
  });
</script>
